<view class="no-scrollbar">

  <view style="padding: 20rpx;">
    <image src="/images/logo.png" class="img-home" />
  </view>
  <t-sticky offset-top="{{0}}" z-index="{{100}}">
    <t-tabs defaultValue="{{0}}" bind:change="onTabsChange" space-evenly="{{false}}" bind:click="onTabsClick">
      <t-tab-panel label="点菜" value="0" />
      <t-tab-panel label="评价" value="1" />
    </t-tabs>
  </t-sticky>

  <t-sticky offset-top="{{50}}">

    <view class="side-bar-wrapper">
      <t-side-bar value="{{sideBarIndex}}" bind:change="onSideBarChange">
        <t-side-bar-item wx:for="{{categories}}" wx:key="label" value="{{item.value || index}}" label="{{item.label}}"
          badge-props="{{item.badgeProps}}" />
      </t-side-bar>
      <view class="content" style="transform: translateY(-{{sideBarIndex * 100}}%)">
        <scroll-view wx:for="{{categories}}" wx:key="label" class="section" scroll-y scroll-top="{{scrollTop}}"
          scroll-with-animation show-scrollbar="{{false}}">
          <view class="title">{{item.title || item.label}}</view>
          <t-cell-group>
            <block wx:for="{{item.items}}" wx:key="index" wx:for-item="cargo">
              <view class="items">
                <image src="{{cargo.image}}" mode="aspectFill" style="width: 200rpx; height: 100rpx;" />
                <t-tag size="small" theme="primary">{{cargo.label}}</t-tag>

                <!-- 新增：加号按钮 -->
                <view class="cartBtn">
                  <view wx:if="{{cargo.cartCount}}">
                    <t-icon name="minus" size="35rpx" color="black" class="minBtn"  bind:tap="addToCart"
                      data-cargo="{{cargo}}" />
                  </view>
                  <text wx:if="{{cargo.cartCount}}">{{cargo.cartCount}}</text>
                  <view>
                    <t-icon name="add" size="35rpx" color="black" class="addBtn" bind:tap="addToCart"
                      data-cargo="{{cargo}}" />
                  </view>
                </view>
              </view>
            </block>
          </t-cell-group>
          <view style="padding-bottom: 100rpx;"></view>
        </scroll-view>
      </view>
    </view>
  </t-sticky>
</view>

<!-- 底部固定栏 -->
<view class="cart-bar" wx:if="{{cartCount}}">
  <view style="display: flex;">
    <t-icon name="cart" size="55rpx" bind:click="cartClick" />
    <t-badge wx:if="{{cartCount}}" class="cart-badge" count="{{cartCount}}" max-count="99" />
  </view>
  <view>
    <t-button shape="round" bind:tap="goCheckout" style="background-color: yellow; color: black;">
      去结算
    </t-button>
  </view>
</view>

<!-- 底部弹出 -->
<t-popup visible="{{cartVisible}}" placement="bottom" close-btn="{{true}}" style="height: 700rpx;"
  bind:visible-change="onVisibleChange">
  <view>1111</view>
  <view>
    <t-button shape="round" bind:tap="closePopup" style="background-color: yellow; color: black;">
      去结算
    </t-button>
  </view>
</t-popup>