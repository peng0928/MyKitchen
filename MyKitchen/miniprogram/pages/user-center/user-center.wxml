<!-- 顶部卡片 -->
<view class="header-card">
  <!-- 左侧头像 -->
  <view class="left">
    <t-avatar t-class="avatar" size="120rpx" image="{{avatarUrl}}" default-avatar="user" bindtap="onAvatarTap" />
    <view style="padding-top: 10rpx; display: flex; align-items: center; text-align: center; gap: 10rpx;" open-type="chooseAvatar" bindtap="getUserProfile" bind:chooseavatar="onChooseAvatar">
      <t-button open-type="chooseAvatar" size="extra-small" icon="refresh" variant="text" bind:chooseavatar="onChooseAvatar" style="color: wheat;">
        同步头像
      </t-button>
    </view>
  </view>

  <!-- 右侧信息 -->
  <view class="info">
    <view class="name">{{userInfo.name}}</view>
    <view class="code">饭搭子号：{{userInfo.fid}}</view>
    <view class="bio">{{userInfo.desc || '这个人很懒，什么都没写~'}}</view>
  </view>
</view>

<!-- 数据面板 -->
<view class="stat-box">
  <view class="stat-item">
    <text class="num">{{stat.follow}}</text>
    <text class="label">关注</text>
  </view>
  <view class="stat-item">
    <text class="num">{{stat.fans}}</text>
    <text class="label">粉丝</text>
  </view>
  <view class="stat-item">
    <text class="num">{{stat.moment}}</text>
    <text class="label">动态</text>
  </view>
</view>

<!-- 列表入口 -->
<t-cell-group>
  <t-cell title="我发布的饭搭子" note="{{stat.moment}}" arrow />
  <t-cell title="我的收藏" arrow />
  <t-cell title="我的饭搭券" arrow />
  <t-cell title="设置" arrow bindtap="goSetting" />
</t-cell-group>

<!-- 退出登录 -->
<view class="footer">
  <t-button theme="danger" variant="text" bindtap="logout">退出登录</t-button>
</view>

<!-- 头像大图预览 & 修改 -->
<t-image-viewer wx:if="{{overlayVisible}}" images="{{[avatarUrl || '/assets/default-avatar.png']}}" visible="{{overlayVisible}}" closeBtn bind:close="closeOverlay" />
<view class="avatar-actions" wx:if="{{overlayVisible}}">
  <t-button theme="primary" bindtap="chooseAvatar">更换头像</t-button>
</view>

<t-message id="t-message" />